'use client';

import React, { createContext, useContext, useState, useEffect } from 'react';

type Language = 'en' | 'vi';

interface LanguageContextType {
    language: Language;
    setLanguage: (lang: Language) => void;
    t: (key: string) => string;
}

type TranslationMap = {
    [key: string]: string;
};

const translations: Record<Language, TranslationMap> = {
  en: {
      // Navigation
      'nav.products': 'Products',
      'nav.orders': 'Orders',
      'nav.bank': 'Bank Management',
      'nav.revenue': 'Revenue',
      'nav.connect_shop': 'Connect Shop',
      'nav.chat': 'Customer Chat',
      'nav.user_management': 'User Management',
      'nav.shop_permissions': 'Shop Permissions',
      'nav.dashboard': 'Dashboard',
      'nav.fraud_alert': 'Fraud Alert',
      
      // Dashboard
      'dashboard.title': 'Dashboard',
      'dashboard.subtitle': 'Overview of your TikTok Shop management system',
      'dashboard.active_shops': 'Active Shops',
      'dashboard.total_orders': 'Total Orders (30d)',
      'dashboard.total_revenue': 'Total Revenue (30d)',
      'dashboard.system_health': 'System Health',
      'dashboard.pending_orders': 'Pending Orders',
      'dashboard.total_payments': 'Total Payments',
      'dashboard.withdrawals': 'Withdrawals',
      'dashboard.pending_payments': 'Pending Payments',
      'dashboard.recent_activity': 'Recent Activity',
      'dashboard.top_shops': 'Top Performing Shops',
      'dashboard.financial_overview': 'Financial Overview (Last 30 Days)',
      'dashboard.total_revenue_label': 'Total Revenue',
      'dashboard.total_withdrawals_label': 'Total Withdrawals',
      'dashboard.net_balance': 'Net Balance',
      'dashboard.excellent': 'Excellent',
      'dashboard.good': 'Good',
      'dashboard.needs_attention': 'Needs Attention',
      'dashboard.no_issues': 'No issues',
      'dashboard.alerts': 'alerts',
      'dashboard.completed': 'completed',
      'dashboard.avg': 'Avg',
      'dashboard.need_fulfillment': 'Need fulfillment',
      'dashboard.last_30_days': 'Last 30 days',
      'dashboard.total_withdrawn': 'Total withdrawn',
      'dashboard.need_processing': 'Need processing',
      'dashboard.no_recent_activity': 'No recent activity',
      'dashboard.no_shop_data': 'No shop performance data available yet',
      
      // Orders
      'orders.title': 'Orders Management',
      'orders.subtitle': 'Manage and sync TikTok orders',
      'orders.total_orders': 'Total Orders',
      'orders.completed': 'Completed',
      'orders.processing': 'Processing',
      'orders.cancelled': 'Cancelled',
      'orders.search': 'Search',
      'orders.search_placeholder': 'Search orders...',
      'orders.shop': 'Shop',
      'orders.all_shops': 'All Shops',
      'orders.status': 'Status',
      'orders.all_status': 'All Status',
      'orders.from_date': 'From Date',
      'orders.to_date': 'To Date',
      'orders.sync_orders': 'Sync Orders',
      'orders.view_details': 'View Details',
      'orders.chat_support': 'Chat Support',
      'orders.account_seller': 'Account/Seller',
      'orders.order': 'Order',
      'orders.order_info': 'Order Info',
      'orders.price': 'Price',
      'orders.actions': 'Actions',
      'orders.items': 'item(s)',
      'orders.track': 'Track',
      'orders.subtotal': 'Subtotal',
      
      // Chat
      'chat.title': 'Customer Chat',
      'chat.shops_messages': 'shops ‚Ä¢ {unread} unread messages',
      'chat.refresh': 'Refresh',
      'chat.seed_data': 'Seed Sample Data',
      'chat.clear_data': 'Clear Sample Data',
      'chat.search_placeholder': 'Search shops or customers...',
      'chat.loading_conversations': 'Loading conversations...',
      'chat.no_conversations': 'No conversations found',
      'chat.conversations': 'conversations',
      'chat.participants': 'participants',
      'chat.cannot_send': 'Cannot send messages',
      'chat.loading_messages': 'Loading messages...',
      'chat.no_messages': 'No messages in this conversation yet',
      'chat.select_conversation': 'Select a conversation',
      'chat.select_conversation_desc': 'Choose a conversation from the sidebar to view messages',
      'chat.readonly_notice': 'This is a read-only view. Use TikTok Shop Seller Center to reply to messages.',
      'chat.unknown_customer': 'Unknown Customer',
      
      // Common
      'common.loading': 'Loading...',
      'common.search': 'Search',
      'common.refresh': 'Refresh',
      'common.save': 'Save',
      'common.cancel': 'Cancel',
      'common.delete': 'Delete',
      'common.edit': 'Edit',
      'common.view': 'View',
      'common.actions': 'Actions',
      'common.status': 'Status',
      'common.date': 'Date',
      'common.total': 'Total',
      'common.yes': 'Yes',
      'common.no': 'No',
      'common.close': 'Close',
      'common.confirm': 'Confirm',
      // ===== Added keys =====
      // Bank Management
      'bank.description': 'Manage bank accounts and assign to shops',
      'bank.import_bank': 'Import Bank',
      'bank.download_template': 'Download CSV Template',
      'bank.history': 'Action History',
      'bank.search_placeholder': 'Search account number, routing number, swift code...',
      'bank.search_results': 'Found {total} bank accounts',
      'bank.clear': 'Clear',
      'bank.info': 'Bank Info',
      'bank.upload_date': 'Upload Date',
      'bank.uploader': 'Uploader',
      'bank.status': 'Status',
      'bank.shop': 'Shop',
      'bank.setup_date': 'Setup Date',
      'bank.assigned_staff': 'Staff',
      'bank.actions': 'Actions',
      'bank.used': 'Used',
      'bank.unused': 'Unused',
      'bank.no_results_with_search': 'No bank accounts match "{search}". Try another term.',
      'bank.no_banks': 'No bank accounts yet. Start by importing your first accounts.',
      'bank.pagination.showing': 'Showing',
      'bank.pagination.to': 'to',
      'bank.pagination.of': 'of',
      'bank.pagination.accounts': 'accounts',
      'bank.previous': 'Previous',
      'bank.next': 'Next',
      'bank.page': 'Page',
      // Import Bank Modal
      'bank.import.title': 'Import Bank',
      'bank.import.csv_format_title': 'Required CSV format:',
      'bank.import.note_description': 'Note: Account holder name or description',
      'bank.import.bank_name_description': 'Bank Name: Full bank name',
      'bank.import.routing_number_description': 'Routing Number: Full routing number',
      'bank.import.swift_code_description': 'Swift Code: International SWIFT code',
      'bank.import.account_number_description': 'Account Number: Full account number (no scientific notation)',
      'bank.import.type_description': 'Type: Account type (Checking, Savings, Business)',
      'bank.import.download_template': 'Download CSV template',
      'bank.import.download_excel': 'Download Excel/CSV template',
      'bank.import.drop_or_click': 'Drop CSV file here or click to select',
      'bank.import.drop_active': 'Drop the file here...',
      'bank.import.upload_file': 'Import file',
      'bank.import.number_format_warning_title': 'Important number format note:',
      'bank.import.number_format_warning_1': 'Account Number and Routing Number must be fully visible',
      'bank.import.number_format_warning_2': 'Do not shorten to scientific form (e.g. 1.55E+14)',
      'bank.import.number_format_warning_3': 'In Excel: Format cells ‚Üí Number ‚Üí 0 decimal places',
      'bank.import.number_format_warning_4': "Or prefix with ' to force text format",
      'bank.import.number_format_warning_5': 'Verify carefully before upload - cannot edit after confirm',
      'bank.import.review_title': 'Review before import',
      'bank.import.file': 'File',
      'bank.import.accounts_count': '{count} accounts',
      'bank.import.confirm': 'Confirm Import ({count} accounts)',
      'bank.import.reupload': 'Re-upload file',
      // Edit Managed Name Modal
      'shop.edit_managed_name.title': 'Update managed name',
      'shop.edit_managed_name.current_shop': 'Current shop:',
      'shop.edit_managed_name.tiktok_name': 'TikTok Name:',
      'shop.edit_managed_name.shop_id': 'Shop ID:',
      'shop.edit_managed_name.new_label': 'New managed name',
      'shop.edit_managed_name.placeholder': 'Enter managed name...',
      'shop.edit_managed_name.helper': 'Helps you identify the shop easily (2-50 characters)',
      'shop.edit_managed_name.min_error': 'Managed name must be at least 2 characters',
      'common.characters_count': '{count}/50',
      'common.saving': 'Saving...',
      'common.save_changes': 'Save Changes',
      // Permissions
      'permissions.title': 'Shop Permissions',
      'permissions.subtitle': 'Manage user access across all shops',
      'permissions.add_user_to_shop': 'Add user to shop',
      'permissions.search_placeholder': 'Search users or shops...',
      'permissions.all_shops': 'All shops',
      'permissions.clear': 'Clear',
      'permissions.results_found': 'Found {total} permissions',
      'permissions.search_results': 'Search results ({total})',
      'permissions.user_access': 'User access ({total})',
      'permissions.items_per_page': 'items per page',
      'permissions.showing_range': 'Showing {from} to {to} of {total} items',
      'permissions.table.user': 'User',
      'permissions.table.shop': 'Shop',
      'permissions.table.role': 'Role',
      'permissions.table.assigned_date': 'Assigned Date',
      'permissions.table.actions': 'Actions',
      'permissions.no_search_results': 'No permissions match your criteria.',
      'permissions.no_permissions': 'No user permissions found. Add a user to a shop to get started.',
      'permissions.edit': 'Edit',
      'permissions.delete': 'Delete',
      'permissions.assign_modal.title': 'Assign user to shop',
      'permissions.assign_modal.user': 'User',
      'permissions.assign_modal.select_user': 'Select user',
      'permissions.assign_modal.shop': 'Shop',
      'permissions.assign_modal.select_shop': 'Select shop',
      'permissions.assign_modal.role_permissions': 'Roles & permissions',
      'permissions.role.owner.label': 'Owner - Owner',
      'permissions.role.owner.desc': 'Full system access to all features',
      'permissions.role.resource.label': 'Resource - Resource Manager',
      'permissions.role.resource.desc': 'Connect and manage shops and system resources (cannot delete shops)',
      'permissions.role.accountant.label': 'Accountant - Accountant',
      'permissions.role.accountant.desc': 'Manage finances, reconciliation, reporting, orders and fulfillment',
      'permissions.role.seller.label': 'Seller - Sales Staff',
      'permissions.role.seller.desc': 'Manage products, orders, listings, promotions, sales activities',
      'permissions.cancel': 'Cancel',
      'permissions.assign': 'Assign',
      'permissions.assigning': 'Assigning...',
      'permissions.edit_modal.title': 'Update user role',
      'permissions.edit_modal.choose_new_role': 'Select new role',
      'permissions.updating': 'Updating...',
      'permissions.update_role': 'Update role',
      'permissions.previous': 'Previous',
      'permissions.next': 'Next',
      'permissions.page': 'Page',
      // Orders (additional / extended)
      'orders.sync_unsettled_transactions': 'Sync Unsettled Transactions',
      'orders.in_progress': 'In Progress',
      'orders.search_placeholder_full': 'Search orders by ID, email, recipient name, or product...',
      'orders.items_images': 'Items Images',
      'orders.customer_info': 'Customer Info',
      'orders.sync_detail': 'Sync Detail',
      'orders.add_tracking': 'Add tracking',
      'orders.split_orders': 'Split orders',
      'orders.view': 'View',
      'orders.no_orders_found': 'No orders found with the selected filters.',
      'orders.mark_delivered': 'Mark Delivered',
      'orders.splitted': 'Order splitted',
      'orders.items_label': 'item(s)',
      'orders.track_label': 'Track: {tracking} - {provider}',

      // Common (missing)
      'common.previous': 'Previous',
      'common.next': 'Next',
      'common.id': 'ID',
      'common.na': 'N/A',
      'common.showing_results': 'Showing {from} to {to} of {total} results',
      'common.page_of': 'Page {current} of {total}',

      // Orders runtime/status (missing)
      'orders.loading_orders': 'Loading orders...',
      'orders.searching_orders': 'Searching orders...',
      'orders.syncing_orders': 'Syncing orders...',
      'orders.syncing_unsettled_transactions': 'Syncing unsettled transactions...',
      'orders.loading_order_details': 'Loading order details...',
      'orders.splitting_order': 'Splitting order...',
      'orders.refreshing': 'Refreshing...',
      'orders.sync_success': 'Orders synced successfully',
      'orders.sync_failed': 'Sync failed',
      'orders.select_shop_sync_unsettled': 'Please select a shop to sync unsettled transactions',
      'orders.unsettled_sync_success': 'Unsettled transactions synced successfully',
      'orders.load_detail_failed': 'Failed to load order details',
      'orders.sync_detail_success': 'Synced detail for {orderId}',
      'orders.sync_detail_failed': 'Sync detail failed',

      // Orders labels (missing)
      'orders.order_status_label': 'Order Status',
      'orders.custom_status': 'Custom Status',
      'orders.page_size': 'Page Size',
      'orders.status_flow': 'Order Status Flow:',
      'orders.shop_id_label': 'Shop ID:',
      'orders.copy_customer_info': 'Copy customer information',
      'orders.mark_as_delivered_title': 'Mark as DELIVERED',
      'orders.add_tracking_title': 'Add tracking information',
      'orders.split_order_title': 'Split order into multiple packages',
      'orders.subtotal_label': 'Subtotal:',
      'orders.estimated_label': 'Est:',
  },
  vi: {
      // Navigation
      'nav.products': 'S·∫£n ph·∫©m',
      'nav.orders': 'ƒê∆°n h√†ng',
      'nav.bank': 'Qu·∫£n l√Ω bank',
      'nav.revenue': 'Ti·ªÅn v·ªÅ',
      'nav.connect_shop': 'K·∫øt n·ªëi Shop',
      'nav.chat': 'Tr√≤ chuy·ªán',
      'nav.user_management': 'Qu·∫£n l√Ω user',
      'nav.shop_permissions': 'Ph√¢n quy·ªÅn shop',
      'nav.dashboard': 'B·∫£ng ƒëi·ªÅu khi·ªÉn',
      'nav.fraud_alert': 'C·∫£nh b√°o gian l·∫≠n',
      
      // Dashboard
      'dashboard.title': 'B·∫£ng ƒëi·ªÅu khi·ªÉn',
      'dashboard.subtitle': 'T·ªïng quan h·ªá th·ªëng qu·∫£n l√Ω TikTok Shop',
      'dashboard.active_shops': 'Shop ho·∫°t ƒë·ªông',
      'dashboard.total_orders': 'T·ªïng ƒë∆°n h√†ng (30 ng√†y)',
      'dashboard.total_revenue': 'T·ªïng doanh thu (30 ng√†y)',
      'dashboard.system_health': 'T√¨nh tr·∫°ng h·ªá th·ªëng',
      'dashboard.pending_orders': 'ƒê∆°n ch·ªù x·ª≠ l√Ω',
      'dashboard.total_payments': 'T·ªïng thanh to√°n',
      'dashboard.withdrawals': 'R√∫t ti·ªÅn',
      'dashboard.pending_payments': 'Thanh to√°n ch·ªù',
      'dashboard.recent_activity': 'Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y',
      'dashboard.top_shops': 'Shop hi·ªáu qu·∫£ nh·∫•t',
      'dashboard.financial_overview': 'T·ªïng quan t√†i ch√≠nh (30 ng√†y qua)',
      'dashboard.total_revenue_label': 'T·ªïng doanh thu',
      'dashboard.total_withdrawals_label': 'T·ªïng r√∫t ti·ªÅn',
      'dashboard.net_balance': 'S·ªë d∆∞ r√≤ng',
      'dashboard.excellent': 'Tuy·ªát v·ªùi',
      'dashboard.good': 'T·ªët',
      'dashboard.needs_attention': 'C·∫ßn ch√∫ √Ω',
      'dashboard.no_issues': 'Kh√¥ng c√≥ v·∫•n ƒë·ªÅ',
      'dashboard.alerts': 'c·∫£nh b√°o',
      'dashboard.completed': 'ho√†n th√†nh',
      'dashboard.avg': 'Trung b√¨nh',
      'dashboard.need_fulfillment': 'C·∫ßn x·ª≠ l√Ω',
      'dashboard.last_30_days': '30 ng√†y qua',
      'dashboard.total_withdrawn': 'T·ªïng ƒë√£ r√∫t',
      'dashboard.need_processing': 'C·∫ßn x·ª≠ l√Ω',
      'dashboard.no_recent_activity': 'Kh√¥ng c√≥ ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y',
      'dashboard.no_shop_data': 'Ch∆∞a c√≥ d·ªØ li·ªáu hi·ªáu qu·∫£ shop',
      
      // Orders
      'orders.title': 'Qu·∫£n l√Ω ƒë∆°n h√†ng',
      'orders.subtitle': 'Qu·∫£n l√Ω v√† ƒë·ªìng b·ªô ƒë∆°n h√†ng TikTok',
      'orders.total_orders': 'T·ªïng ƒë∆°n h√†ng',
      'orders.completed': 'Ho√†n th√†nh',
      'orders.processing': 'ƒêang x·ª≠ l√Ω',
      'orders.cancelled': 'ƒê√£ h·ªßy',
      'orders.search': 'T√¨m ki·∫øm',
      'orders.search_placeholder': 'T√¨m ƒë∆°n h√†ng...',
      'orders.shop': 'C·ª≠a h√†ng',
      'orders.all_shops': 'T·∫•t c·∫£ shop',
      'orders.status': 'Tr·∫°ng th√°i',
      'orders.all_status': 'T·∫•t c·∫£ tr·∫°ng th√°i',
      'orders.from_date': 'T·ª´ ng√†y',
      'orders.to_date': 'ƒê·∫øn ng√†y',
      'orders.sync_orders': 'ƒê·ªìng b·ªô ƒë∆°n h√†ng',
      'orders.view_details': 'Xem chi ti·∫øt',
      'orders.chat_support': 'H·ªó tr·ª£',
      'orders.account_seller': 'T√†i kho·∫£n/Ng∆∞·ªùi b√°n',
      'orders.order': 'ƒê∆°n h√†ng',
      'orders.order_info': 'Th√¥ng tin ƒë∆°n',
      'orders.price': 'Gi√°',
      'orders.actions': 'Thao t√°c',
      'orders.items': 's·∫£n ph·∫©m',
      'orders.track': 'Theo d√µi',
      'orders.subtotal': 'T·∫°m t√≠nh',
      
      // Chat
      'chat.title': 'Tr√≤ chuy·ªán kh√°ch h√†ng',
      'chat.shops_messages': 'shop ‚Ä¢ {unread} tin nh·∫Øn ch∆∞a ƒë·ªçc',
      'chat.refresh': 'L√†m m·ªõi',
      'chat.seed_data': 'T·∫°o d·ªØ li·ªáu m·∫´u',
      'chat.clear_data': 'X√≥a d·ªØ li·ªáu m·∫´u',
      'chat.search_placeholder': 'T√¨m shop ho·∫∑c kh√°ch h√†ng...',
      'chat.loading_conversations': 'ƒêang t·∫£i cu·ªôc tr√≤ chuy·ªán...',
      'chat.no_conversations': 'Kh√¥ng t√¨m th·∫•y cu·ªôc tr√≤ chuy·ªán',
      'chat.conversations': 'cu·ªôc tr√≤ chuy·ªán',
      'chat.participants': 'ng∆∞·ªùi tham gia',
      'chat.cannot_send': 'Kh√¥ng th·ªÉ g·ª≠i tin nh·∫Øn',
      'chat.loading_messages': 'ƒêang t·∫£i tin nh·∫Øn...',
      'chat.no_messages': 'Ch∆∞a c√≥ tin nh·∫Øn trong cu·ªôc tr√≤ chuy·ªán',
      'chat.select_conversation': 'Ch·ªçn cu·ªôc tr√≤ chuy·ªán',
      'chat.select_conversation_desc': 'Ch·ªçn cu·ªôc tr√≤ chuy·ªán t·ª´ thanh b√™n ƒë·ªÉ xem tin nh·∫Øn',
      'chat.readonly_notice': 'ƒê√¢y l√† ch·∫ø ƒë·ªô ch·ªâ ƒë·ªçc. S·ª≠ d·ª•ng TikTok Shop Seller Center ƒë·ªÉ tr·∫£ l·ªùi tin nh·∫Øn.',
      'chat.unknown_customer': 'Kh√°ch h√†ng kh√¥ng x√°c ƒë·ªãnh',
      
      // Common
      'common.loading': 'ƒêang t·∫£i...',
      'common.search': 'T√¨m ki·∫øm',
      'common.refresh': 'L√†m m·ªõi',
      'common.save': 'L∆∞u',
      'common.cancel': 'H·ªßy',
      'common.delete': 'X√≥a',
      'common.edit': 'S·ª≠a',
      'common.view': 'Xem',
      'common.actions': 'Thao t√°c',
      'common.status': 'Tr·∫°ng th√°i',
      'common.date': 'Ng√†y',
      'common.total': 'T·ªïng',
      'common.yes': 'C√≥',
      'common.no': 'Kh√¥ng',
      'common.close': 'ƒê√≥ng',
      'common.confirm': 'X√°c nh·∫≠n',
      // ===== Added keys =====
      'bank.description': 'Qu·∫£n l√Ω t√†i kho·∫£n ng√¢n h√†ng v√† g√°n cho shop',
      'bank.import_bank': 'Import Bank',
      'bank.download_template': 'T·∫£i m·∫´u CSV',
      'bank.history': 'L·ªãch s·ª≠ h√†nh ƒë·ªông',
      'bank.search_placeholder': 'T√¨m Account number, Routing number, Swift code...',
      'bank.search_results': 'T√¨m th·∫•y {total} t√†i kho·∫£n ng√¢n h√†ng',
      'bank.clear': 'X√≥a',
      'bank.info': 'Th√¥ng tin Bank',
      'bank.upload_date': 'Ng√†y upload',
      'bank.uploader': 'Ng∆∞·ªùi upload',
      'bank.status': 'T√¨nh tr·∫°ng',
      'bank.shop': 'Shop',
      'bank.setup_date': 'Ng√†y set up',
      'bank.assigned_staff': 'Nh√¢n s·ª±',
      'bank.actions': 'H√†nh ƒë·ªông',
      'bank.used': 'ƒê√£ d√πng',
      'bank.unused': 'Ch∆∞a d√πng',
      'bank.no_results_with_search': 'Kh√¥ng c√≥ t√†i kho·∫£n tr√πng v·ªõi "{search}". Th·ª≠ t·ª´ kh√≥a kh√°c.',
      'bank.no_banks': 'Ch∆∞a c√≥ t√†i kho·∫£n ng√¢n h√†ng. B·∫Øt ƒë·∫ßu b·∫±ng c√°ch import.',
      'bank.pagination.showing': 'Hi·ªÉn th·ªã',
      'bank.pagination.to': 'ƒë·∫øn',
      'bank.pagination.of': 'c·ªßa',
      'bank.pagination.accounts': 't√†i kho·∫£n',
      'bank.previous': 'Tr∆∞·ªõc',
      'bank.next': 'Ti·∫øp theo',
      'bank.page': 'Trang',
      // Import Bank Modal
      'bank.import.title': 'Import Bank',
      'bank.import.csv_format_title': 'ƒê·ªãnh d·∫°ng CSV y√™u c·∫ßu:',
      'bank.import.note_description': 'Note: Ghi ch√∫ ho·∫∑c t√™n ch·ªß t√†i kho·∫£n',
      'bank.import.bank_name_description': 'Bank Name: T√™n ng√¢n h√†ng ƒë·∫ßy ƒë·ªß',
      'bank.import.routing_number_description': 'Routing Number: S·ªë ƒë·ªãnh tuy·∫øn',
      'bank.import.swift_code_description': 'Swift Code: M√£ SWIFT qu·ªëc t·∫ø',
      'bank.import.account_number_description': 'Account Number: ƒê·∫ßy ƒë·ªß (kh√¥ng d·∫°ng khoa h·ªçc)',
      'bank.import.type_description': 'Type: Lo·∫°i t√†i kho·∫£n (Checking, Savings...)',
      'bank.import.download_template': 'T·∫£i file m·∫´u CSV',
      'bank.import.download_excel': 'T·∫£i m·∫´u Excel/CSV',
      'bank.import.drop_or_click': 'K√©o th·∫£ file CSV ho·∫∑c nh·∫•p ƒë·ªÉ ch·ªçn',
      'bank.import.drop_active': 'Th·∫£ file v√†o ƒë√¢y...',
      'bank.import.upload_file': 'Import file',
      'bank.import.number_format_warning_title': '‚ö†Ô∏è L∆∞u √Ω ƒë·ªãnh d·∫°ng s·ªë:',
      'bank.import.number_format_warning_1': 'Account Number & Routing Number ph·∫£i hi·ªÉn th·ªã ƒë·∫ßy ƒë·ªß',
      'bank.import.number_format_warning_2': 'Kh√¥ng r√∫t g·ªçn d·∫°ng 1.55E+14',
      'bank.import.number_format_warning_3': 'Trong Excel: Format cells ‚Üí Number ‚Üí 0 decimal',
      'bank.import.number_format_warning_4': "Ho·∫∑c th√™m d·∫•u ' ƒë·ªÉ th√†nh d·∫°ng text",
      'bank.import.number_format_warning_5': 'Ki·ªÉm tra k·ªπ tr∆∞·ªõc khi x√°c nh·∫≠n - kh√¥ng th·ªÉ s·ª≠a',
      'bank.import.review_title': 'Ki·ªÉm tra tr∆∞·ªõc khi import',
      'bank.import.file': 'File',
      'bank.import.accounts_count': '{count} t√†i kho·∫£n',
      'bank.import.confirm': '‚úÖ X√°c nh·∫≠n Import ({count} t√†i kho·∫£n)',
      'bank.import.reupload': 'üîÑ Upload l·∫°i file',
      // Edit Managed Name Modal
      'shop.edit_managed_name.title': 'C·∫≠p nh·∫≠t t√™n qu·∫£n l√Ω',
      'shop.edit_managed_name.current_shop': 'Shop hi·ªán t·∫°i:',
      'shop.edit_managed_name.tiktok_name': 'TikTok Name:',
      'shop.edit_managed_name.shop_id': 'Shop ID:',
      'shop.edit_managed_name.new_label': 'T√™n qu·∫£n l√Ω m·ªõi',
      'shop.edit_managed_name.placeholder': 'Nh·∫≠p t√™n qu·∫£n l√Ω...',
      'shop.edit_managed_name.helper': 'Gi√∫p b·∫°n nh·∫≠n di·ªán shop (2-50 k√Ω t·ª±)',
      'shop.edit_managed_name.min_error': 'T√™n qu·∫£n l√Ω ph·∫£i √≠t nh·∫•t 2 k√Ω t·ª±',
      'common.characters_count': '{count}/50',
      'common.saving': 'ƒêang l∆∞u...',
      'common.save_changes': 'L∆∞u thay ƒë·ªïi',
      // Permissions
      'permissions.title': 'Ph√¢n quy·ªÅn c·ª≠a h√†ng',
      'permissions.subtitle': 'Qu·∫£n l√Ω quy·ªÅn truy c·∫≠p ng∆∞·ªùi d√πng tr√™n t·∫•t c·∫£ shop',
      'permissions.add_user_to_shop': 'Th√™m ng∆∞·ªùi d√πng v√†o c·ª≠a h√†ng',
      'permissions.search_placeholder': 'T√¨m ki·∫øm ng∆∞·ªùi d√πng ho·∫∑c c·ª≠a h√†ng...',
      'permissions.all_shops': 'T·∫•t c·∫£ c·ª≠a h√†ng',
      'permissions.clear': 'X√≥a',
      'permissions.results_found': 'T√¨m th·∫•y {total} quy·ªÅn',
      'permissions.search_results': 'K·∫øt qu·∫£ t√¨m ki·∫øm ({total})',
      'permissions.user_access': 'Quy·ªÅn truy c·∫≠p c·ªßa ng∆∞·ªùi d√πng ({total})',
      'permissions.items_per_page': 'm·ª•c m·ªói trang',
      'permissions.showing_range': 'Hi·ªÉn th·ªã {from} ƒë·∫øn {to} c·ªßa {total} m·ª•c',
      'permissions.table.user': 'Ng∆∞·ªùi d√πng',
      'permissions.table.shop': 'C·ª≠a h√†ng',
      'permissions.table.role': 'Quy·ªÅn',
      'permissions.table.assigned_date': 'Ng√†y ph√¢n c√¥ng',
      'permissions.table.actions': 'Thao t√°c',
      'permissions.no_search_results': 'Kh√¥ng c√≥ quy·ªÅn n√†o kh·ªõp ti√™u ch√≠ t√¨m ki·∫øm.',
      'permissions.no_permissions': 'Ch∆∞a c√≥ quy·ªÅn. Th√™m ng∆∞·ªùi d√πng v√†o c·ª≠a h√†ng ƒë·ªÉ b·∫Øt ƒë·∫ßu.',
      'permissions.edit': 'S·ª≠a',
      'permissions.delete': 'X√≥a',
      'permissions.assign_modal.title': 'Ph√¢n quy·ªÅn ng∆∞·ªùi d√πng v√†o c·ª≠a h√†ng',
      'permissions.assign_modal.user': 'Ng∆∞·ªùi d√πng',
      'permissions.assign_modal.select_user': 'Ch·ªçn ng∆∞·ªùi d√πng',
      'permissions.assign_modal.shop': 'C·ª≠a h√†ng',
      'permissions.assign_modal.select_shop': 'Ch·ªçn c·ª≠a h√†ng',
      'permissions.assign_modal.role_permissions': 'Vai tr√≤ & quy·ªÅn h·∫°n',
      'permissions.role.owner.label': 'Owner - Ch·ªß s·ªü h·ªØu',
      'permissions.role.owner.desc': 'To√†n quy·ªÅn h·ªá th·ªëng',
      'permissions.role.resource.label': 'Resource - Qu·∫£n l√Ω T√†i nguy√™n',
      'permissions.role.resource.desc': 'K·∫øt n·ªëi & qu·∫£n l√Ω shop (kh√¥ng ƒë∆∞·ª£c x√≥a shop)',
      'permissions.role.accountant.label': 'Accountant - K·∫ø to√°n',
      'permissions.role.accountant.desc': 'Qu·∫£n l√Ω t√†i ch√≠nh, ƒë·ªëi so√°t, b√°o c√°o, ƒë∆°n h√†ng',
      'permissions.role.seller.label': 'Seller - Nh√¢n vi√™n b√°n h√†ng',
      'permissions.role.seller.desc': 'Qu·∫£n l√Ω s·∫£n ph·∫©m, ƒë∆°n h√†ng, khuy·∫øn m√£i',
      'permissions.cancel': 'H·ªßy',
      'permissions.assign': 'Ph√¢n quy·ªÅn',
      'permissions.assigning': 'ƒêang ph√¢n quy·ªÅn...',
      'permissions.edit_modal.title': 'C·∫≠p nh·∫≠t quy·ªÅn ng∆∞·ªùi d√πng',
      'permissions.edit_modal.choose_new_role': 'Ch·ªçn vai tr√≤ m·ªõi',
      'permissions.updating': 'ƒêang c·∫≠p nh·∫≠t...',
      'permissions.update_role': 'C·∫≠p nh·∫≠t quy·ªÅn',
      'permissions.previous': 'Tr∆∞·ªõc',
      'permissions.next': 'Ti·∫øp theo',
      'permissions.page': 'Trang',
      // Orders additions
      'orders.sync_unsettled_transactions': 'Sync Unsettled Transaction',
      'orders.in_progress': 'ƒêang x·ª≠ l√Ω',
      'orders.search_placeholder_full': 'T√¨m ƒë∆°n theo ID, email, t√™n ng∆∞·ªùi nh·∫≠n ho·∫∑c s·∫£n ph·∫©m...',
      'orders.items_images': 'H√¨nh ·∫£nh SP',
      'orders.customer_info': 'Th√¥ng tin KH',
      'orders.sync_detail': 'Sync Detail',
      'orders.add_tracking': 'Th√™m tracking',
      'orders.split_orders': 'Split orders',
      'orders.view': 'Xem',
      'orders.no_orders_found': 'Kh√¥ng c√≥ ƒë∆°n h√†ng v·ªõi b·ªô l·ªçc hi·ªán t·∫°i.',
      'orders.mark_delivered': 'K√©o ƒë∆°n',
      'orders.splitted': 'ƒê√£ split order',
      'orders.items_label': ' s·∫£n ph·∫©m',
      'orders.track_label': 'Track: {tracking} - {provider}',

      // Common (missing)
      'common.previous': 'Tr∆∞·ªõc',
      'common.next': 'Ti·∫øp theo',
      'common.id': 'ID',
      'common.na': 'N/A',
      'common.showing_results': 'Hi·ªÉn th·ªã {from} ƒë·∫øn {to} c·ªßa {total} k·∫øt qu·∫£',
      'common.page_of': 'Trang {current} / {total}',

      // Orders runtime/status (missing)
      'orders.loading_orders': 'ƒêang t·∫£i ƒë∆°n h√†ng...',
      'orders.searching_orders': 'ƒêang t√¨m ki·∫øm ƒë∆°n h√†ng...',
      'orders.syncing_orders': 'ƒêang ƒë·ªìng b·ªô ƒë∆°n h√†ng...',
      'orders.syncing_unsettled_transactions': 'ƒêang ƒë·ªìng b·ªô giao d·ªãch ch∆∞a quy·∫øt to√°n...',
      'orders.loading_order_details': 'ƒêang t·∫£i chi ti·∫øt ƒë∆°n h√†ng...',
      'orders.splitting_order': 'ƒêang t√°ch ƒë∆°n...',
      'orders.refreshing': 'ƒêang l√†m m·ªõi...',
      'orders.sync_success': 'ƒê·ªìng b·ªô ƒë∆°n h√†ng th√†nh c√¥ng',
      'orders.sync_failed': 'ƒê·ªìng b·ªô th·∫•t b·∫°i',
      'orders.select_shop_sync_unsettled': 'Vui l√≤ng ch·ªçn shop ƒë·ªÉ ƒë·ªìng b·ªô giao d·ªãch ch∆∞a quy·∫øt to√°n',
      'orders.unsettled_sync_success': 'ƒê·ªìng b·ªô giao d·ªãch ch∆∞a quy·∫øt to√°n th√†nh c√¥ng',
      'orders.load_detail_failed': 'T·∫£i chi ti·∫øt ƒë∆°n h√†ng th·∫•t b·∫°i',
      'orders.sync_detail_success': 'ƒê√£ sync chi ti·∫øt cho {orderId}',
      'orders.sync_detail_failed': 'Sync chi ti·∫øt th·∫•t b·∫°i',

      // Orders labels (missing)
      'orders.order_status_label': 'Tr·∫°ng th√°i ƒë∆°n',
      'orders.custom_status': 'Tr·∫°ng th√°i n·ªôi b·ªô',
      'orders.page_size': 'S·ªë d√≤ng / trang',
      'orders.status_flow': 'Lu·ªìng tr·∫°ng th√°i ƒë∆°n:',
      'orders.shop_id_label': 'Shop ID:',
      'orders.copy_customer_info': 'Sao ch√©p th√¥ng tin kh√°ch h√†ng',
      'orders.mark_as_delivered_title': 'ƒê√°nh d·∫•u ƒë√£ k√©o ƒë∆°n',
      'orders.add_tracking_title': 'Th√™m th√¥ng tin tracking',
      'orders.split_order_title': 'T√°ch ƒë∆°n th√†nh nhi·ªÅu ki·ªán',
      'orders.subtotal_label': 'T·∫°m t√≠nh:',
      'orders.estimated_label': 'Est:',
  }
};

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
    const [language, setLanguageState] = useState<Language>('vi');

    useEffect(() => {
        // Load saved language from localStorage
        const savedLanguage = localStorage.getItem('language') as Language;
        if (savedLanguage && (savedLanguage === 'en' || savedLanguage === 'vi')) {
            setLanguageState(savedLanguage);
        }
    }, []);

    const setLanguage = (lang: Language) => {
        setLanguageState(lang);
        localStorage.setItem('language', lang);
    };

    const t = (key: string, params?: Record<string, string | number>) => {
        let translation = translations[language][key] || translations['en'][key] || key;
        
        // Replace parameters in translation
        if (params) {
            Object.entries(params).forEach(([paramKey, value]) => {
                translation = translation.replace(`{${paramKey}}`, String(value));
            });
        }
        
        return translation;
    };

    return (
        <LanguageContext.Provider value={{ language, setLanguage, t }}>
            {children}
        </LanguageContext.Provider>
    );
};

export const useLanguage = () => {
    const context = useContext(LanguageContext);
    if (context === undefined) {
        throw new Error('useLanguage must be used within a LanguageProvider');
    }
    return context;
};
